<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Generic Gtk.TreeView Generator - Journal of an Open Sourcee</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://omaciel.github.io/generic-gtktreeview-generator.html">

        <meta name="author" content="Og Maciel" />
        <meta name="keywords" content="english" />
        <meta name="description" content="Quite a few people have asked me to publish my attempt at simplifying the process of creating and using a Gtk.TreeView (see this post). The truth is that life has been a bit hectic these last 5-6 weeks and I didn’t get to do any more development on ..." />

        <meta property="og:site_name" content="Journal of an Open Sourcee" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Generic Gtk.TreeView Generator"/>
        <meta property="og:url" content="https://omaciel.github.io/generic-gtktreeview-generator.html"/>
        <meta property="og:description" content="Quite a few people have asked me to publish my attempt at simplifying the process of creating and using a Gtk.TreeView (see this post). The truth is that life has been a bit hectic these last 5-6 weeks and I didn’t get to do any more development on ..."/>
        <meta property="article:published_time" content="2007-06-16" />
            <meta property="article:section" content="English" />
            <meta property="article:tag" content="english" />
            <meta property="article:author" content="Og Maciel" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://omaciel.github.io/theme/css/bootstrap.united.min.css" type="text/css"/>
    <link href="https://omaciel.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://omaciel.github.io/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="https://omaciel.github.io/theme/css/style.css" type="text/css"/>

        <link href="https://omaciel.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Journal of an Open Sourcee ATOM Feed"/>
        <link href="https://omaciel.github.io/feeds.rss" type="application/rss+xml" rel="alternate"
              title="Journal of an Open Sourcee RSS Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://omaciel.github.io/" class="navbar-brand">
Journal of an Open Sourcee            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li class="active">
                            <a href="https://omaciel.github.io/category/english.html">English</a>
                        </li>
                        <li >
                            <a href="https://omaciel.github.io/category/portuguese.html">Portuguese</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://omaciel.github.io/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://omaciel.github.io/generic-gtktreeview-generator.html"
                       rel="bookmark"
                       title="Permalink to Generic Gtk.TreeView Generator">
                        Generic Gtk.TreeView Generator
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2007-06-16T13:47:00-04:00"> Sat 16 June 2007</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="https://omaciel.github.io/tag/english.html">english</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Quite a few people have asked me to publish my attempt at simplifying
the process of creating and using a Gtk.TreeView (see
<a class="reference external" href="http://www.ogmaciel.com/?p=344">this</a> post). The truth is that life
has been a bit hectic these last 5-6 weeks and I didn’t get to do any
more development on it. But I think it is still very usefull, even if
only as a learning aid. The code will be published to a few repositories
very soon, but in the meantime, you can copy it inline right here (read
the rest of this post). I’m also including a sample class that makes use
of this generic class.</p>
<p><strong>genericlistview.py</strong></p>
<pre class="code literal-block">
&quot;&quot;&quot;
Copyright (c) 2007, Og Maciel

All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted
provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice, this list of
      conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice, this list
      of conditions and the following disclaimer in the documentation and/or other materials
      provided with the distribution.
    * Neither the name of the Og Maciel nor the names of its contributors may be used to
      endorse or promote products derived from this software without specific prior written
      permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
&quot;&quot;&quot;

# -*- coding: utf-8 -*-

import gtk
import gobject

class GenericListView(gtk.TreeView):
    &quot;&quot;&quot;
    This class represent a generic ListView
    &quot;&quot;&quot;

    def __init__ (self, columns=None):
        &quot;&quot;&quot;
        Constructor

        &#64;type columns: dictionary
        &#64;param columns: Dictionary containing ordered list of the columns to be displayed,
            with the index as its key, followed by a list containing the column
            title, and gtk.CellRenderer type.
            Ex: columns = {0: [None, gtk.CellRendererToggle()]}
        &#64;rtype: None
        &#64;return: None.
        &quot;&quot;&quot;
        # Call the super class
        gtk.TreeView.__init__ (self)

        # If columns were passed, use them.  Else, columns from derived class.
        if columns:
            self.columns = columns

        #self.set_fixed_height_mode(True)

        # Setup the list
        self._setupListView(self.columns)

    def _setupListView(self, columns):
        &quot;&quot;&quot;
        Initializes the ListView object by dynamically creating a ListStore
        and adding necessary columns based on the &#64;columns parameter.

        &#64;type columns: dictionary
        &#64;param columns: Dictionary containing ordered list of the columns to be displayed,
            with the index as its key, followed by a list containing the column
            title, gtk.CellRenderer type, and custom function.
            Ex: columns = {0: [None, gtk.CellRendererToggle(), myfunction]}
        &#64;rtype: None
        &#64;return: None.
        &quot;&quot;&quot;
        # Temporary containers for datatypes and treeviewcolumns
        dataTypes = []
        treeViewColumns = []
        # Extract information from dictionary value
        for key, value in columns.items():
            # Column title
            title = value[0]
            # Column gtk.CellRenderer
            cellrenderer = value[1]

            # Get data type
            dataType = self._getColumnInfo(cellrenderer)
            # Get gtk.TreeViewColumn
            tvColumn = self._getTreeViewColumn(title, cellrenderer, key)
            # Add to temporary datatype and treeviewcolumns containers
            dataTypes.append(dataType)
            treeViewColumns.append(tvColumn)

        # Defines the TreeStore
        #self.listStore = gtk.ListStore(*dataTypes)
        self.listStore = gtk.TreeStore(*dataTypes)
        # Associates the listStore to the ListView object
        self.set_model(self.listStore)

        # Add columns to the List
        for column in treeViewColumns:
            self.append_column(column)

        # If TRUE, hint to the theme engine to draw rows in alternating colors.
        self.set_rules_hint(True)

    def _getTreeViewColumn(self, title, type, index):
        &quot;&quot;&quot;
        Returns a gtk.TreeViewColumn with the title, gtk.CellRenderer,
        and attributes based on the title and CellRendererType passed.

        &#64;type title: string
        &#64;param title: String containing text to display as column header.
        &#64;type type: gtk.CellRenderer
        &#64;param type: gtk.CellRenderer to associate with column.
        &#64;type index: integer
        &#64;param index: This is the location where the new gtk.TreeViewColumn will obtain its data.
        &#64;rtype: gtk.TreeViewColumn
        &#64;return: Returns a gtk.TreeViewColumn with the title, gtk.CellRenderer,
            and attributes based on the title and CellRendererType passed.
        &quot;&quot;&quot;
        if isinstance(type, gtk.CellRendererToggle):
            tvcolumn = gtk.TreeViewColumn(title, type, active=index)
        elif isinstance(type, gtk.CellRendererPixbuf):
            tvcolumn = gtk.TreeViewColumn(title, type, pixbuf=index)
        else:
            tvcolumn = gtk.TreeViewColumn(title, type, text=index)

        tvcolumn.set_resizable(True)
        tvcolumn.set_clickable(True)

        return tvcolumn

    def _getColumnInfo(self, value):
        &quot;&quot;&quot;
        Return the data type to be used when building a gtk.ListStore.

        &#64;type value: gtk.CellRenderer
        &#64;param value: The gtk.CellRenderer associated with column.
        &#64;rtype: GObject
        &#64;return: Returns a tuple containing the data type (GObject).
        &quot;&quot;&quot;
        if isinstance(value, gtk.CellRendererToggle):
            value.connect (&quot;toggled&quot;, self.toggled_item)
            type = gobject.TYPE_BOOLEAN
        elif isinstance(value, gtk.CellRendererText):
            type = gobject.TYPE_STRING
        elif isinstance(value, gtk.CellRendererPixbuf):
            type = gtk.gdk.Pixbuf
        else:
            type = gobject.TYPE_NONE

        return type

    # Events
    # TODO: Remove this from here and move it to the inherited class.
    def toggled_item(self, cell, path):
        &quot;&quot;&quot;
        Toggles CellRendererToggle on/off.

        &#64;type : integer
        &#64;param : .
        &#64;rtype: list
        &#64;return: .
        &quot;&quot;&quot;
        self.listStore[path][0] = not self.listStore[path][0]

    # Control Procedures
    def add(self, value, parent=None):
        &quot;&quot;&quot;
        Add an item to the internal liststore

        &#64;type value: list
        &#64;param value: List containing the data to add to the internal liststore.
        &#64;type parent: gtk.TreeIter
        &#64;param parent: Parent node or None.
        &#64;rtype: gtk.TreeIter
        &#64;return: A gtk.TreeIter pointing at the new row.
        &quot;&quot;&quot;
        return self.listStore.append(parent, value)

    def addList(self, values, parent=None):
        &quot;&quot;&quot;
        Add multiple itens to the internal liststore

        &#64;type values: list
        &#64;param values: List of lists containing the data to add to the internal liststore.
        &#64;type parent: gtk.TreeIter
        &#64;param parent: Parent node or None.
        &#64;rtype: None
        &#64;return: None.
        &quot;&quot;&quot;
        # Removes the model so the addition is quicker
        self.set_model(None)
        # Freezes list so to cancel refresh event
        self.freeze_child_notify()

        for value in values:
            self.listStore.append(parent, value)

        # set model back
        self.set_model(self.listStore)
        # Unfreeze the list
        self.thaw_child_notify()

    def remove(self):
        &quot;&quot;&quot;
        Remove the selected row

        &#64;rtype: None
        &#64;return: None.
        &quot;&quot;&quot;
        #http://eccentric.cx/misc/pygtk/pygtkfaq.html#13.8
        selection = self.get_selection()
        model, iter = selection.get_selected()
        if iter:
          path = model.get_path(iter)
          model.remove(iter)
          # now that we removed the selection, play nice with
          # the user and select the next item
          selection.select_path(path)

          # well, if there was no selection that meant the user
          # removed the last entry, so we try to select the
          # last item
          if not selection.path_is_selected(path):
             row = path[0]-1
             # test case for empty lists
             if row &gt;= 0:
                selection.select_path((row,))

    def getSelectedRow(self):
        &quot;&quot;&quot;
        Get the entire selected row.

        &#64;rtype: list
        &#64;return: Returns a list containing the data from the selected row.
        &quot;&quot;&quot;
        selection = self.get_selection()
        model, paths = selection.get_selected_rows()

        # Returns first selected row
        return paths[0]

    def getSelectedItem(self, index):
        &quot;&quot;&quot;
        Return the indexed item from the selected row.

        &#64;type index: integer
        &#64;param index: Index of the column item to return.
        &#64;rtype: str
        &#64;return: Returns the value for the cell in the selected row.
        &quot;&quot;&quot;
        selection = self.get_selection()
        model, iter, = selection.get_selected()
        return  self.store.get_value(iter, index)

    def getCount(self):
        &quot;&quot;&quot;
        Returns the number of itens in the list.

        &#64;rtype: int
        &#64;return: Returns the number of itens in the list.
        &quot;&quot;&quot;

        return len(self.listStore)
</pre>
<p>And here is the derived class:</p>
<p><strong>derivedclass.py</strong></p>
<pre class="code literal-block">
# -*- coding: utf-8 -*-

import gtk
from genericlistview import GenericListView

class BillListView(GenericListView):
    &quot;&quot;&quot;
    This class represents a ListView for bills.
    &quot;&quot;&quot;

    # This dictionary represents the columns displayed by the listview.
    # It is indexed by the order you want them to be displayed, followed
    # by the column title and cellrenderer type.
    columns = {
        0: [None, gtk.CellRendererPixbuf()],
        1: ['Payee', gtk.CellRendererText()],
        2: ['Amount Due', gtk.CellRendererText()],
        3: ['Due Date', gtk.CellRendererText()]
</pre>

            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'journalofanopensourcee'; // required: replace example with your forum shortname

                    var disqus_identifier = 'generic-gtktreeview-generator';
                var disqus_url = 'https://omaciel.github.io/generic-gtktreeview-generator.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/omaciel"><i class="fa fa-github-square fa-lg"></i> GitHub</a></li>
                <li class="list-group-item"><a href="https://twitter.com/OgMaciel"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
                <li class="list-group-item"><a href="http://www.linkedin.com/pub/og-maciel/7/425/257/"><i class="fa fa-linkedin-square fa-lg"></i> LinkedIn</a></li>
                <li class="list-group-item"><a href="https://www.goodreads.com/user/show/12048315-og-maciel"><i class="fa fa-goodreads-square fa-lg"></i> GoodReads</a></li>
                <li class="list-group-item"><a href="http://instagram.com/ogmaciel"><i class="fa fa-instagram-square fa-lg"></i> Instagram</a></li>
              </ul>
            </li>



            <li class="list-group-item"><a href="https://omaciel.github.io/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group " id="tags">
                </ul>
            </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Og Maciel
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://omaciel.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://omaciel.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://omaciel.github.io/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'journalofanopensourcee'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

</body>
</html>